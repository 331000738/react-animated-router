"use strict";Object.defineProperty(exports,"__esModule",{value:true});function e(e){return e&&typeof e==="object"&&"default"in e?e["default"]:e}var t=e(require("@babel/runtime/helpers/esm/classCallCheck"));var n=e(require("@babel/runtime/helpers/esm/createClass"));var r=e(require("@babel/runtime/helpers/esm/possibleConstructorReturn"));var i=e(require("@babel/runtime/helpers/esm/getPrototypeOf"));var o=e(require("@babel/runtime/helpers/esm/inherits"));var a=require("react");var s=e(a);var u=require("react-dom");var l=require("react-transition-group");var c=require("react-router");var p={key:"",isPush:true};var f="REACT_HISTORIES_KEY";var d=(sessionStorage.getItem(f)||"").split(",").filter(Boolean);var m=function e(t,n){var r=t.key||t.pathname+t.search;if(n&&r!==p.key){var i=d.lastIndexOf(r);if(i>-1){d.splice(i+1)}else{d.push(r)}sessionStorage.setItem(f,d.join(","));p={isPush:i<0,key:r}}return p.isPush};var v=function(e){o(a,e);function a(){var e;var n;t(this,a);for(var o=arguments.length,s=new Array(o),u=0;u<o;u++){s[u]=arguments[u]}n=r(this,(e=i(a)).call.apply(e,[this].concat(s)));n.inTransition=false;n.rootNode=void 0;n.lastTransitionNode=void 0;n.onEnter=function(e){n.inTransition||n.setInTransition(n.inTransition=true);n.lastTransitionNode=e};n.onEntering=function(e){var t=n.props.timeout;if(e&&typeof t==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration=t+"ms"}};n.onEntered=function(e){if(n.lastTransitionNode===e){n.inTransition&&n.setInTransition(n.inTransition=false)}if(e){var t=n.props.timeout;e.className=e.className.split(/\s+/).filter(function(e){return!/-(?:forward|backward)-(?:enter|exit)(?:-active)?$/.test(e)}).join(" ");if(typeof t==="number"){e.style.transitionDuration=e.style.WebkitTransitionDuration=e.style.MozTransitionDuration=""}}};return n}n(a,[{key:"setInTransition",value:function e(t){if(this.rootNode){var n=this.props.prefix+"-in-transition";this.rootNode.className=this.rootNode.className.split(/\s+/).filter(function(e){return e!==n}).concat(t?n:[]).join(" ")}}},{key:"componentDidMount",value:function e(){this.rootNode=u.findDOMNode(this)}},{key:"render",value:function e(){var t=this.props,n=t.className,r=t.location,i=t.children,o=t.timeout,a=t.prefix,u=t.appear,p=t.enter,f=t.exit,d=t.component;var v={appear:u,enter:p,exit:f,component:d};var h={onExit:this.onEnter,onExiting:this.onEntering,onExited:this.onEntered,onEnter:this.onEnter,onEntering:this.onEntering,onEntered:this.onEntered};var E=[a+"-container","react-animated-router",n];return s.createElement(l.TransitionGroup,Object.assign({className:E.filter(Boolean).join(" "),childFactory:function e(t){var n=a+"-"+(m(r,t.props.in)?"forward":"backward");return s.cloneElement(t,{classNames:n})}},v),s.createElement(l.CSSTransition,Object.assign({key:this.props.transitionKey||r.pathname,addEndListener:function e(t,n){t.addEventListener("transitionend",function(e){if(e.target===t){n()}},false)},unmountOnExit:true,timeout:o},h),s.createElement(c.Switch,{location:r},i)))}}]);return a}(a.Component);v.defaultProps={prefix:"animated-router"};var h=c.withRouter(v);exports.default=h;
