import t,{Component as n}from"react";import{findDOMNode as e}from"react-dom";import{TransitionGroup as o,CSSTransition as r}from"react-transition-group";import{withRouter as i,Switch as a}from"react-router";function s(t,n){if(!(t instanceof n)){throw new TypeError("Cannot call a class as a function")}}function u(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||false;o.configurable=true;if("value"in o)o.writable=true;Object.defineProperty(t,o.key,o)}}function f(t,n,e){if(n)u(t.prototype,n);if(e)u(t,e);return t}function c(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){c=function t(n){return typeof n}}else{c=function t(n){return n&&typeof Symbol==="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n}}return c(t)}function l(t){if(typeof Symbol==="function"&&c(Symbol.iterator)==="symbol"){l=function t(n){return c(n)}}else{l=function t(n){return n&&typeof Symbol==="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":c(n)}}return l(t)}function p(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function y(t,n){if(n&&(l(n)==="object"||typeof n==="function")){return n}return p(t)}function m(t){m=Object.setPrototypeOf?Object.getPrototypeOf:function t(n){return n.__proto__||Object.getPrototypeOf(n)};return m(t)}function d(t,n){d=Object.setPrototypeOf||function t(n,e){n.__proto__=e;return n};return d(t,n)}function b(t,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:true,configurable:true}});if(n)d(t,n)}var h={key:"",isPush:true};var v="REACT_HISTORIES_KEY";var E=(sessionStorage.getItem(v)||"").split(",").filter(Boolean);var T=function t(n,e){var o=n.key||n.pathname+n.search;if(e&&o!==h.key){var r=E.lastIndexOf(o);if(r>-1){E.splice(r+1)}else{E.push(o)}sessionStorage.setItem(v,E.join(","));h={isPush:r<0,key:o}}return h.isPush};var g=function(n){b(i,n);function i(){var t;var n;s(this,i);for(var e=arguments.length,o=new Array(e),r=0;r<e;r++){o[r]=arguments[r]}n=y(this,(t=m(i)).call.apply(t,[this].concat(o)));n.inTransition=false;n.rootNode=void 0;n.lastTransitionNode=void 0;n.onEnter=function(t){n.inTransition||n.setInTransition(n.inTransition=true);n.lastTransitionNode=t};n.onEntering=function(t){var e=n.props.timeout;if(t&&typeof e==="number"){t.style.transitionDuration=t.style.WebkitTransitionDuration=t.style.MozTransitionDuration=e+"ms"}};n.onEntered=function(t){if(n.lastTransitionNode===t){n.inTransition&&n.setInTransition(n.inTransition=false)}if(t){var e=n.props.timeout;t.className=t.className.split(/\s+/).filter(function(t){return!/-(?:forward|backward)-(?:enter|exit)(?:-active)?$/.test(t)}).join(" ");if(typeof e==="number"){t.style.transitionDuration=t.style.WebkitTransitionDuration=t.style.MozTransitionDuration=""}}};return n}f(i,[{key:"setInTransition",value:function t(n){if(this.rootNode){var e=this.props.prefix+"-in-transition";this.rootNode.className=this.rootNode.className.split(/\s+/).filter(function(t){return t!==e}).concat(n?e:[]).join(" ")}}},{key:"componentDidMount",value:function t(){this.rootNode=e(this)}},{key:"render",value:function n(){var e=this.props,i=e.className,s=e.location,u=e.children,f=e.timeout,c=e.prefix,l=e.appear,p=e.enter,y=e.exit,m=e.component;var d={appear:l,enter:p,exit:y,component:m};var b={onExit:this.onEnter,onExiting:this.onEntering,onExited:this.onEntered,onEnter:this.onEnter,onEntering:this.onEntering,onEntered:this.onEntered};var h=[c+"-container","react-animated-router",i];return t.createElement(o,Object.assign({className:h.filter(Boolean).join(" "),childFactory:function n(e){var o=c+"-"+(T(s,e.props.in)?"forward":"backward");return t.cloneElement(e,{classNames:o})}},d),t.createElement(r,Object.assign({key:this.props.transitionKey||s.pathname,addEndListener:function t(n,e){n.addEventListener("transitionend",function(t){if(t.target===n){e()}},false)},unmountOnExit:true,timeout:f},b),t.createElement(a,{location:s},u)))}}]);return i}(n);g.defaultProps={prefix:"animated-router"};var N=i(g);export default N;
